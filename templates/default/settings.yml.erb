defaults: &defaults
  useragent: <%= node[:alm][:useragent] %>
  api_key: <%= node[:alm][:api_key] %>
  notification_email: <%= node[:alm][:admin][:email] %>
  rest_auth_site_key: <%= node[:alm][:key] %>
  rest_auth_digest_stretches: 10
  secret_token: <%= node[:alm][:secret] %>
  persona: <%= node[:alm][:persona] %>
  cas_url: <%= node[:alm][:cas_url] %>
  cas_login_url: <%= node[:alm][:cas_prefix] %>/login
  cas_logout_url: <%= node[:alm][:cas_prefix] %>/logout
  cas_service_validate_url: <%= node[:alm][:cas_prefix] %>/serviceValidate
  workers: <%= node[:alm][:workers] %>
  couchdb_url: http://<%= node[:alm][:host] %>:<%= node[:couch_db][:config][:httpd][:port] %>/<%= node[:alm][:name] %>/
  doi_prefix: <%= node[:alm][:doi_prefix] %>
  uid: <%= node[:alm][:uid] %>
  mail:
    address: <%= node[:alm][:mail][:address] %>
    port: <%= node[:alm][:mail][:port] %>
    domain: <%= node[:alm][:mail][:domain] %>

development:
  <<: *defaults
  hostname: <%= node[:alm][:hostname] %>

test:
  <<: *defaults
  api_key: 12345
  hostname: test.example.org
  notification_email: alm@alm.example.org
  cas_url: https://example.org
  workers: 1
  couchdb_url: http://localhost:<%= node[:couch_db][:config][:httpd][:port] %>/<%= node[:alm][:name] %>_test/
  doi_prefix: <%= node[:alm][:doi_prefix] %>

production:
  <<: *defaults
  hostname: <%= node[:alm][:hostname] %>
